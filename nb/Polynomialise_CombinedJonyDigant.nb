(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     86167,       2114]
NotebookOptionsPosition[     83134,       2017]
NotebookOutlinePosition[     83521,       2033]
CellTagsIndexPosition[     83478,       2030]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Polynomialiser: Digant\[CloseCurlyQuote]s function with \
Jony\[CloseCurlyQuote]s score bolted on\
\>", "Title",
 CellChangeTimes->{{3.6639231283441124`*^9, 3.6639231569874907`*^9}}],

Cell["Load the double pendulum data with dt = 0.1", "Text",
 CellChangeTimes->{{3.6639231807254086`*^9, 3.6639232014321127`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReadData", "[", "sz_", "]"}], ":=", 
   RowBox[{"Transpose", "[", " ", 
    RowBox[{"Partition", "[", " ", 
     RowBox[{
      RowBox[{"ReadList", "[", " ", 
       RowBox[{"sz", ",", " ", "Number", ",", " ", 
        RowBox[{"RecordSeparators", "\[Rule]", 
         RowBox[{"{", "\"\<,\>\"", "}"}]}]}], "]"}], ",", " ", "2"}], "]"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6639167696142693`*^9, 3.663916775262288*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"experimentalData", " ", "=", " ", 
   RowBox[{
   "ReadData", "[", "\"\<c:/Users/User/Desktop/mma_double.csv\>\"", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6639166758673525`*^9, 3.6639166768570557`*^9}, {
  3.663916778897894*^9, 3.6639167855226164`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"deltat", ":=", "0.1"}], ";"}]], "Input",
 CellChangeTimes->{{3.6639167893633366`*^9, 3.6639167916749935`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"times", " ", "=", "  ", 
   RowBox[{
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"experimentalData", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}], "]"}], 
    "*", "deltat"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.663916800355158*^9, 3.663916812586073*^9}}],

Cell["\<\
Construct velocities and accelerations using interpolating polynomials - \
there must be a better way to empiracally differentiate.\
\>", "Text",
 CellChangeTimes->{{3.663923216849107*^9, 3.663923258601787*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"expth1", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"times", ",", " ", 
      RowBox[{
       RowBox[{"experimentalData", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "+", "1*^-15"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expth2", " ", "=", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"times", ",", " ", 
      RowBox[{
       RowBox[{"experimentalData", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", "1*^-15"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expw1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Interpolation", "[", "expth1", "]"}], ")"}], "'"}], "[", 
    "times", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expw2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Interpolation", "[", "expth2", "]"}], ")"}], "'"}], "[", 
    "times", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expa1", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Interpolation", "[", "expth1", "]"}], ")"}], "''"}], "[", 
    "times", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expa2", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Interpolation", "[", "expth2", "]"}], ")"}], "''"}], "[", 
    "times", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expth1", " ", "=", " ", 
   RowBox[{"experimentalData", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expth2", " ", "=", " ", 
   RowBox[{"experimentalData", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6639158191730385`*^9, 3.6639158230377884`*^9}, {
  3.663916043499178*^9, 3.6639160763144956`*^9}, {3.6639168302346582`*^9, 
  3.663916882678971*^9}, {3.663922789833288*^9, 3.6639228401130447`*^9}, {
  3.6639230053415985`*^9, 3.6639230582172184`*^9}}],

Cell["\<\
Assemble these into a set of rules of the form {th1->{...}, th1d->{...}, \
th1dd->{...}, th2->{...},th2d->{...}, th2dd->{...}}\
\>", "Text",
 CellChangeTimes->{{3.6639232685158405`*^9, 3.663923321429489*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"myExperimentalData", " ", "=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"th1", "\[Rule]", "expth1"}], ",", " ", 
        RowBox[{
         RowBox[{"symbolAppend", "[", 
          RowBox[{"th1", ",", " ", "\"\<d\>\""}], "]"}], "\[Rule]", "expw1"}],
         ",", " ", 
        RowBox[{
         RowBox[{"symbolAppend", "[", 
          RowBox[{"th1", ",", " ", "\"\<dd\>\""}], "]"}], "\[Rule]", 
         "expa1"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"th2", "\[Rule]", "expth2"}], ",", " ", 
        RowBox[{
         RowBox[{"symbolAppend", "[", 
          RowBox[{"th2", ",", " ", "\"\<d\>\""}], "]"}], "\[Rule]", "expw2"}],
         ",", " ", 
        RowBox[{
         RowBox[{"symbolAppend", "[", 
          RowBox[{"th2", ",", " ", "\"\<dd\>\""}], "]"}], "\[Rule]", 
         "expa2"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.663916886202449*^9, 3.6639168946594725`*^9}, {
  3.663917256248597*^9, 3.6639173744336824`*^9}, {3.663917491464946*^9, 
  3.6639175055519695`*^9}, {3.6639175957631683`*^9, 3.6639176065628514`*^9}, {
  3.6639230638061943`*^9, 3.6639230882485857`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"symbolAppend", "[", 
    RowBox[{"symbol_", ",", "postfix_"}], "]"}], ":=", 
   RowBox[{"Symbol", "[", 
    RowBox[{
     RowBox[{"SymbolName", "[", "symbol", "]"}], "<>", "postfix"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dotVar", "[", "v_", "]"}], ":=", 
   RowBox[{"symbolAppend", "[", 
    RowBox[{"v", ",", "\"\<dot\>\""}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6639119467674065`*^9, 3.663911950378972*^9}}],

Cell[" ", "Text",
 CellChangeTimes->{{3.663923343411127*^9, 3.663923431524816*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"generateTransformations", "[", "vars_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dotVars", ",", "toTimeDependent", ",", "toDerivatives"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dotVars", "=", 
      RowBox[{"dotVar", "/@", "vars"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"toTimeDependent", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Rule]", 
         RowBox[{"#", "[", "t", "]"}]}], "&"}], "/@", 
       RowBox[{"Join", "[", 
        RowBox[{"vars", ",", "dotVars"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"toDerivatives", "=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"dotVar", "[", "#", "]"}], "[", "t", "]"}], "\[Rule]", 
         RowBox[{
          RowBox[{"#", "'"}], "[", "t", "]"}]}], "&"}], "/@", "vars"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"toTimeDependent", ",", "toDerivatives"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"generateTransformations", "[", 
  RowBox[{"{", 
   RowBox[{"x1", ",", "x2"}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.663912472709054*^9, 3.6639124817204666`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "\[Rule]", 
      RowBox[{"x1", "[", "t", "]"}]}], ",", 
     RowBox[{"x2", "\[Rule]", 
      RowBox[{"x2", "[", "t", "]"}]}], ",", 
     RowBox[{"x1dot", "\[Rule]", 
      RowBox[{"x1dot", "[", "t", "]"}]}], ",", 
     RowBox[{"x2dot", "\[Rule]", 
      RowBox[{"x2dot", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x1dot", "[", "t", "]"}], "\[Rule]", 
      RowBox[{
       SuperscriptBox["x1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], ",", 
     RowBox[{
      RowBox[{"x2dot", "[", "t", "]"}], "\[Rule]", 
      RowBox[{
       SuperscriptBox["x2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.66391248213978*^9, 3.6639166971865244`*^9, {3.6639168998401794`*^9, 
   3.663916901739502*^9}, {3.663916991167944*^9, 3.663916999446834*^9}, {
   3.663930166394761*^9, 3.66393016917474*^9}}]
}, Open  ]],

Cell["", "Text"],

Cell["This is Digant\[CloseCurlyQuote]s polynomialiser", "Text",
 CellChangeTimes->{{3.663923444897332*^9, 3.663923460832669*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"polynomialiser2", "[", 
    RowBox[{"vars_", ",", " ", "indv_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nVars", ",", " ", "fullVarList", ",", " ", "monoList", ",", " ", 
       "coeffs"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nVars", " ", "=", " ", 
       RowBox[{"2", "*", 
        RowBox[{"Length", "[", "vars", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fullVarList", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"#", ",", 
            RowBox[{"dotVar", "[", "#", "]"}]}], "}"}], "&"}], "/@", "vars"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"monoList", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           SuperscriptBox["fullVarList", "#"], ")"}]}], "&"}], " ", "/@", " ",
         "indv"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"coeffs", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{"\"\<c\>\"", "<>", 
           RowBox[{"ToString", "[", "#", "]"}]}], "]"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"Length", "[", "monoList", "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"coeffs", ",", " ", 
        RowBox[{"monoList", ".", "coeffs"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.6639119567915635`*^9, {3.66391256305033*^9, 3.6639125838311167`*^9}, {
   3.663912636971923*^9, 3.663912649754016*^9}, {3.6639301744935503`*^9, 
   3.6639301755923324`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MakeInput", "[", "]"}], ":=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{"10", ",", " ", 
        RowBox[{"{", 
         RowBox[{"7", ",", "4"}], "}"}]}], "]"}], "}"}], ",", "1"}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "=", 
   RowBox[{"{", 
    RowBox[{"th1", ",", " ", "th2"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6639119861062613`*^9, 3.6639119981868267`*^9}}],

Cell["Use this as a simple example", "Text",
 CellChangeTimes->{{3.663923487334524*^9, 3.663923492340115*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gadata", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6639120071021986`*^9, 3.663912024214373*^9}, {
   3.6639122331342273`*^9, 3.663912236787856*^9}, {3.663916729354414*^9, 
   3.6639167311647005`*^9}, {3.663916932212184*^9, 3.6639169453785496`*^9}, {
   3.6639221876597757`*^9, 3.663922195452321*^9}, 3.6639234793378325`*^9, {
   3.6639248908650875`*^9, 3.66392489371911*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.663916731956259*^9, {3.663916915741467*^9, 3.6639169457308006`*^9}, 
   3.663917010058384*^9, 3.6639221959987087`*^9, 3.663923495172098*^9, 
   3.6639248941434116`*^9, 3.6639301818147664`*^9}]
}, Open  ]],

Cell["\<\
The output in this example is a list of the coefficients ppp[[1]], and the \
polynomial itself with th1dot etc for the differentials wrt time\
\>", "Text",
 CellChangeTimes->{{3.663923541890338*^9, 3.663923582268071*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ppp", "=", 
  RowBox[{"polynomialiser2", "[", 
   RowBox[{"vars", ",", " ", "gadata"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.663912026934309*^9, 3.663912038187287*^9}, {
  3.6639128429352527`*^9, 3.6639128482690477`*^9}, {3.6639169270445232`*^9, 
  3.6639169518441677`*^9}, {3.663923509906582*^9, 3.6639235355498276`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"c1", ",", "c2", ",", "c3"}], "}"}], ",", 
   RowBox[{
    RowBox[{"c1", " ", "th1", " ", "th1dot", " ", "th2", " ", "th2dot"}], "+", 
    RowBox[{"c3", " ", "th1", " ", 
     SuperscriptBox["th1dot", "2"], " ", "th2", " ", 
     SuperscriptBox["th2dot", "2"]}], "+", 
    RowBox[{"c2", " ", 
     SuperscriptBox["th1", "2"], " ", 
     SuperscriptBox["th1dot", "2"], " ", 
     SuperscriptBox["th2", "2"], " ", 
     SuperscriptBox["th2dot", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6639235102188206`*^9, 3.6639235372780557`*^9}, 
   3.663924897299678*^9, 3.663930187833029*^9}]
}, Open  ]],

Cell["\<\
The generateELScore and the generateNScore takes the variables and creates a \
symbolic score function. The function that is generated has a single argument \
which is the polynomial.\
\>", "Text",
 CellChangeTimes->{{3.6639235997064767`*^9, 3.663923735698227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateELScore", "[", "vars_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toTimeDependent", ",", "toDerivatives"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"toTimeDependent", ",", "toDerivatives"}], "}"}], "=", 
      RowBox[{"generateTransformations", "[", "vars", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"l", ",", "\[IndentingNewLine]", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"D", "[", 
                   RowBox[{
                    RowBox[{"l", "/.", "toTimeDependent"}], ",", 
                    RowBox[{
                    RowBox[{"dotVar", "[", "#", "]"}], "[", "t", "]"}]}], 
                   "]"}], "/.", "toDerivatives"}], ",", "t"}], "]"}], "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"l", "/.", "toTimeDependent"}], ",", 
                 RowBox[{"#", "[", "t", "]"}]}], "]"}]}], "/.", 
              "toDerivatives"}], ")"}], "2"], "&"}], "/@", "vars"}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateNScore", "[", "vars_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"toTimeDependent", ",", "toDerivatives"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"toTimeDependent", ",", "toDerivatives"}], "}"}], "=", 
      RowBox[{"generateTransformations", "[", "vars", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Function", "[", 
      RowBox[{"l", ",", "\[IndentingNewLine]", 
       RowBox[{"Plus", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"D", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"D", "[", 
                  RowBox[{
                   RowBox[{"l", "/.", "toTimeDependent"}], ",", 
                   RowBox[{
                    RowBox[{"dotVar", "[", "#", "]"}], "[", "t", "]"}]}], 
                  "]"}], "/.", "toDerivatives"}], ",", "t"}], "]"}], ")"}], 
             "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"l", "/.", "toTimeDependent"}], ",", 
                 RowBox[{"#", "[", "t", "]"}]}], "]"}], "/.", 
               "toDerivatives"}], ")"}], "2"]}], "&"}], "/@", "vars"}], 
         ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"targetUnity", "[", "x_", "]"}], ":=", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Log", "[", 
     RowBox[{
      SuperscriptBox["10", 
       RowBox[{"-", "25"}]], "+", "x"}], "]"}], "2"], "+", "1"}]}]], "Input"],

Cell["\<\
So with our polynomial ppp[[2]] we get the following function for the \
normalisation. \
\>", "Text",
 CellChangeTimes->{{3.6639237514604473`*^9, 3.6639237729747763`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateNScore", "[", 
   RowBox[{"{", 
    RowBox[{"th1", ",", " ", "th2"}], "}"}], "]"}], "[", 
  RowBox[{"ppp", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.663919004956783*^9, 3.6639190299375577`*^9}, {
  3.6639222344480658`*^9, 3.6639222357880187`*^9}, {3.6639222721219635`*^9, 
  3.6639222831397753`*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"c3", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", "c2", " ", 
      SuperscriptBox[
       RowBox[{"th1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}], "2"], 
  "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"c3", " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", "c2", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"th2", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}]}], ")"}], "2"], 
  "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", "c3", " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "3"], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", "c2", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"th2", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "3"], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", "c3", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"4", " ", "c2", " ", 
      SuperscriptBox[
       RowBox[{"th1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", "c3", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", "c2", " ", 
      SuperscriptBox[
       RowBox[{"th1", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"th2", "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", "c3", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", "c2", " ", 
      SuperscriptBox[
       RowBox[{"th1", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"th2", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", "c3", " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"4", " ", "c2", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"th2", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
     RowBox[{"2", " ", "c3", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "3"]}], "+", 
     RowBox[{"4", " ", "c2", " ", 
      SuperscriptBox[
       RowBox[{"th1", "[", "t", "]"}], "2"], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "3"]}], "+", 
     RowBox[{"2", " ", "c3", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"2", " ", "c2", " ", 
      SuperscriptBox[
       RowBox[{"th1", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"th2", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["th2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", "c3", " ", 
      RowBox[{"th1", "[", "t", "]"}], " ", 
      RowBox[{"th2", "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], "+", 
     RowBox[{"4", " ", "c2", " ", 
      SuperscriptBox[
       RowBox[{"th1", "[", "t", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"th2", "[", "t", "]"}], "2"], " ", 
      RowBox[{
       SuperscriptBox["th1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}], " ", 
      RowBox[{
       SuperscriptBox["th2", "\[Prime]\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}]}], ")"}], 
   "2"]}]], "Output",
 CellChangeTimes->{{3.66391901930099*^9, 3.6639190308622146`*^9}, 
   3.6639222065492153`*^9, 3.6639222366926613`*^9, {3.663922276493043*^9, 
   3.663922283511037*^9}, 3.6639249044157143`*^9, 3.663931137155965*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeControlTrajectory", "[", 
   RowBox[{"vars_", ",", "tTrain_", ",", "tStep_"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"#", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"0.1", " ", "t"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "tTrain", ",", "tStep"}], "}"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"symbolAppend", "[", 
         RowBox[{"#", ",", "\"\<d\>\""}], "]"}], "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{"0.1", " ", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "tTrain", ",", "tStep"}], "}"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"symbolAppend", "[", 
         RowBox[{"#", ",", "\"\<dd\>\""}], "]"}], "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "tTrain", ",", "tStep"}], "}"}]}], 
         "]"}]}]}], "}"}], "&"}], "/@", "vars"}], "]"}]}]], "Input"],

Cell[TextData[{
 "Create the control data as a list of rules { th1->{...}, th1d->{...}, \
th1dd->{...}, ... etc}. It is done this way so that we can use our data to \
control a gigantic algebraic function and then use ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to symbolically simplify it. "
}], "Text",
 CellChangeTimes->{{3.6639237892703705`*^9, 3.663923890423338*^9}}],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"myControlData", " ", "=", " ", 
    RowBox[{"makeControlTrajectory", "[", 
     RowBox[{"vars", ",", " ", 
      RowBox[{"times", "[", 
       RowBox[{"[", 
        RowBox[{"Length", "[", "times", "]"}], "]"}], "]"}], ",", " ", 
      "deltat"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6639131862446537`*^9, 3.6639131948427496`*^9}, {
  3.663916643715483*^9, 3.663916654863408*^9}, {3.6639170641768723`*^9, 
  3.6639170762594757`*^9}, {3.6639171161548815`*^9, 3.663917141166647*^9}, {
  3.6639171755261693`*^9, 3.6639172029476743`*^9}}],

Cell["\<\
pathSum is where the rules for the experimental data are now substituted into \
the polynomial and the entire thing summed and simplified. So we get a large \
quatatic form in C1 etc\
\>", "Text",
 CellChangeTimes->{{3.6639239262177753`*^9, 3.6639239701690664`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pathSum", "[", 
   RowBox[{"vars_", ",", "score_", ",", "p_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "toData", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"toData", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", "t", "]"}], "\[Rule]", "#"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "'"}], "[", "t", "]"}], "\[Rule]", 
            RowBox[{"symbolAppend", "[", 
             RowBox[{"#", ",", "\"\<d\>\""}], "]"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "''"}], "[", "t", "]"}], "\[Rule]", 
            RowBox[{"symbolAppend", "[", 
             RowBox[{"#", ",", "\"\<dd\>\""}], "]"}]}]}], "}"}], "&"}], "/@", 
        "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"score", "/.", "toData"}], ")"}], "/.", "p"}], ")"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateScore", "[", 
   RowBox[{"vars_", ",", "l_", ",", "trajectory_", ",", "controlTrj_"}], 
   "]"}], ":=", 
  RowBox[{"Log", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "10"}]], "+", 
        RowBox[{"Expand", "[", 
         RowBox[{"pathSum", "[", 
          RowBox[{"vars", ",", 
           RowBox[{
            RowBox[{"generateELScore", "[", "vars", "]"}], "[", "l", "]"}], 
           ",", "trajectory"}], "]"}], "]"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["10", 
         RowBox[{"-", "10"}]], "+", 
        RowBox[{"Expand", "[", 
         RowBox[{"pathSum", "[", 
          RowBox[{"vars", ",", 
           RowBox[{
            RowBox[{"generateELScore", "[", "vars", "]"}], "[", "l", "]"}], 
           ",", "controlTrj"}], "]"}], "]"}]}], ")"}]}], ")"}], 
    RowBox[{"targetUnity", "[", 
     RowBox[{"Expand", "[", 
      RowBox[{"pathSum", "[", 
       RowBox[{"vars", ",", 
        RowBox[{
         RowBox[{"generateNScore", "[", "vars", "]"}], "[", "l", "]"}], ",", 
        "controlTrj"}], "]"}], "]"}], "]"}], 
    RowBox[{"targetUnity", "[", 
     RowBox[{"Expand", "[", 
      RowBox[{"pathSum", "[", 
       RowBox[{"vars", ",", 
        RowBox[{
         RowBox[{"generateELScore", "[", "vars", "]"}], "[", "l", "]"}], ",", 
        "controlTrj"}], "]"}], "]"}], "]"}]}], "]"}]}]], "Input"],

Cell["\<\
As can be seen the whole thing simplifies down very very nicely!!!!!!!!!!!!!!\
\>", "Text",
 CellChangeTimes->{{3.6639239950708075`*^9, 3.663924008431279*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"pathSum", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"th1", ",", " ", "th2"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"generateELScore", "[", 
      RowBox[{"{", 
       RowBox[{"th1", ",", " ", "th2"}], "}"}], "]"}], "[", 
     RowBox[{"ppp", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", "myExperimentalData"}],
    "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6639176300095463`*^9, 3.6639176357335887`*^9}, {
  3.6639181439081416`*^9, 3.6639181944471054`*^9}, {3.663918304082116*^9, 
  3.6639183441245885`*^9}, {3.663918947181678*^9, 3.663918967404065*^9}, {
  3.663919048244582*^9, 3.6639190484877543`*^9}, {3.6639191272557974`*^9, 
  3.6639191727891927`*^9}, {3.6639207083984423`*^9, 3.6639207179162135`*^9}, {
  3.663922163216403*^9, 3.663922175380056*^9}, {3.663922374262605*^9, 
  3.6639223750561695`*^9}, {3.663922882789406*^9, 3.663922885917632*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"3223.23728133853`", " ", 
   SuperscriptBox["c1", "2"]}], "-", 
  RowBox[{"18856.419139687467`", " ", "c1", " ", "c2"}], "+", 
  RowBox[{"79681.33313259712`", " ", 
   SuperscriptBox["c2", "2"]}], "-", 
  RowBox[{"41057.96777052856`", " ", "c1", " ", "c3"}], "+", 
  RowBox[{"309112.11146537913`", " ", "c2", " ", "c3"}], "+", 
  RowBox[{"395977.22332280094`", " ", 
   SuperscriptBox["c3", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.6639189696186433`*^9, 3.6639190495635233`*^9, {3.6639191466666093`*^9, 
   3.6639191736067915`*^9}, 3.6639207442126117`*^9, {3.6639221680027914`*^9, 
   3.663922176286701*^9}, 3.663922311765139*^9, 3.6639223757086325`*^9, 
   3.6639228865640917`*^9, 3.663931156513891*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Expand", "[", 
  RowBox[{"pathSum", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"th1", ",", " ", "th2"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{"generateELScore", "[", 
      RowBox[{"{", 
       RowBox[{"th1", ",", " ", "th2"}], "}"}], "]"}], "[", 
     RowBox[{"ppp", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", "myControlData"}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6639191919288263`*^9, 3.663919197027467*^9}, {
  3.6639207596485944`*^9, 3.663920760475212*^9}}],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "+", 
  RowBox[{"0.006767000000000005`", " ", 
   SuperscriptBox["c1", "2"]}], "+", 
  RowBox[{"0.0004920799992000005`", " ", "c1", " ", "c2"}], "+", 
  RowBox[{"0.000010649314165716014`", " ", 
   SuperscriptBox["c2", "2"]}], "+", 
  RowBox[{"0.0004060200000000003`", " ", "c1", " ", "c3"}], "+", 
  RowBox[{"0.000014762399976000017`", " ", "c2", " ", "c3"}], "+", 
  RowBox[{"6.090300000000006`*^-6", " ", 
   SuperscriptBox["c3", "2"]}]}]], "Output",
 CellChangeTimes->{3.6639207611796837`*^9, 3.663922326870903*^9, 
  3.6639228903147764`*^9, 3.6639311592008004`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"targetUnity", "[", 
  RowBox[{"Expand", "[", 
   RowBox[{"pathSum", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"th1", ",", " ", "th2"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{"generateNScore", "[", 
       RowBox[{"{", 
        RowBox[{"th1", ",", " ", "th2"}], "}"}], "]"}], "[", 
      RowBox[{"ppp", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", " ", "myControlData"}], 
    "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6639207762524247`*^9, 3.6639208641668134`*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  SuperscriptBox[
   RowBox[{"Log", "[", 
    RowBox[{"9.999999999999999`*^-26", "+", 
     RowBox[{"0.03383500000000002`", " ", 
      SuperscriptBox["c1", "2"]}], "+", 
     RowBox[{"0.0014762399976000014`", " ", "c1", " ", "c2"}], "+", 
     RowBox[{"0.000020115371201908028`", " ", 
      SuperscriptBox["c2", "2"]}], "+", 
     RowBox[{"0.001218060000000001`", " ", "c1", " ", "c3"}], "+", 
     RowBox[{"0.000027884533288000032`", " ", "c2", " ", "c3"}], "+", 
     RowBox[{"0.000011503900000000009`", " ", 
      SuperscriptBox["c3", "2"]}]}], "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.6639208475269904`*^9, 3.6639208646231537`*^9}, 
   3.6639229008202343`*^9, 3.6639311624501143`*^9}]
}, Open  ]],

Cell["The whole score function:", "Text",
 CellChangeTimes->{{3.663924023392914*^9, 3.6639240286956987`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"myScoreFn", " ", "=", " ", 
  RowBox[{"generateScore", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"th1", ",", " ", "th2"}], "}"}], ",", 
    RowBox[{"ppp", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", " ", "myExperimentalData", ",", " ",
     "myControlData"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.663917639189047*^9, 3.6639176563482857`*^9}, {
  3.6639176979948874`*^9, 3.663917700184445*^9}, {3.66391793081153*^9, 
  3.663917941193945*^9}, {3.663920621736784*^9, 3.663920638745886*^9}, {
  3.663922945213819*^9, 3.663922948164939*^9}}],

Cell[BoxData[
 RowBox[{"Log", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "10000000000"], "+", 
       RowBox[{"3223.23728133853`", " ", 
        SuperscriptBox["c1", "2"]}], "-", 
       RowBox[{"18856.419139687467`", " ", "c1", " ", "c2"}], "+", 
       RowBox[{"79681.33313259712`", " ", 
        SuperscriptBox["c2", "2"]}], "-", 
       RowBox[{"41057.96777052856`", " ", "c1", " ", "c3"}], "+", 
       RowBox[{"309112.11146537913`", " ", "c2", " ", "c3"}], "+", 
       RowBox[{"395977.22332280094`", " ", 
        SuperscriptBox["c3", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"Log", "[", 
         RowBox[{"9.999999999999999`*^-26", "+", 
          RowBox[{"0.006767000000000005`", " ", 
           SuperscriptBox["c1", "2"]}], "+", 
          RowBox[{"0.0004920799992000005`", " ", "c1", " ", "c2"}], "+", 
          RowBox[{"0.000010649314165716014`", " ", 
           SuperscriptBox["c2", "2"]}], "+", 
          RowBox[{"0.0004060200000000003`", " ", "c1", " ", "c3"}], "+", 
          RowBox[{"0.000014762399976000017`", " ", "c2", " ", "c3"}], "+", 
          RowBox[{"6.090300000000006`*^-6", " ", 
           SuperscriptBox["c3", "2"]}]}], "]"}], "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox[
        RowBox[{"Log", "[", 
         RowBox[{"9.999999999999999`*^-26", "+", 
          RowBox[{"0.03383500000000002`", " ", 
           SuperscriptBox["c1", "2"]}], "+", 
          RowBox[{"0.0014762399976000014`", " ", "c1", " ", "c2"}], "+", 
          RowBox[{"0.000020115371201908028`", " ", 
           SuperscriptBox["c2", "2"]}], "+", 
          RowBox[{"0.001218060000000001`", " ", "c1", " ", "c3"}], "+", 
          RowBox[{"0.000027884533288000032`", " ", "c2", " ", "c3"}], "+", 
          RowBox[{"0.000011503900000000009`", " ", 
           SuperscriptBox["c3", "2"]}]}], "]"}], "2"]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"1.`*^-10", "+", 
     RowBox[{"0.006767000000000005`", " ", 
      SuperscriptBox["c1", "2"]}], "+", 
     RowBox[{"0.0004920799992000005`", " ", "c1", " ", "c2"}], "+", 
     RowBox[{"0.000010649314165716014`", " ", 
      SuperscriptBox["c2", "2"]}], "+", 
     RowBox[{"0.0004060200000000003`", " ", "c1", " ", "c3"}], "+", 
     RowBox[{"0.000014762399976000017`", " ", "c2", " ", "c3"}], "+", 
     RowBox[{"6.090300000000006`*^-6", " ", 
      SuperscriptBox["c3", "2"]}]}], ")"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.663920627981228*^9, 3.6639206399987783`*^9}, 
   3.663922913092983*^9, 3.663922948791381*^9, 3.6639249157747955`*^9, 
   3.663931166455964*^9}]
}, Open  ]],

Cell["Shamelessly lifted:", "Text",
 CellChangeTimes->{{3.6639240405811434`*^9, 3.663924054290925*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nmSolve", "[", 
   RowBox[{"scoreExpression_", ",", "coeffs_", ",", "model_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "sol", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"err", "=", 
      RowBox[{"{", "}"}]}], ";", 
     RowBox[{"step", "=", "0"}], ";", 
     RowBox[{"eval", "=", "0"}], ";", 
     RowBox[{"dimensions", "=", 
      RowBox[{"Length", "[", "coeffs", "]"}]}], ";", 
     RowBox[{"bestModel", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"{", "scoreExpression", "}"}], ",", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1.0"}], "<", "#", "<", "1.0"}], "&"}], "/@", 
            "coeffs"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", "coeffs", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"AccuracyGoal", "\[Rule]", "10"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PrecisionGoal", "\[Rule]", "10"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Method", "\[Rule]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"\"\<NelderMead\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<PostProcess\>\"", "\[Rule]", "False"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ExpandRatio\>\"", "\[Rule]", 
            RowBox[{"1", "+", 
             RowBox[{"(", 
              RowBox[{"2", "/", 
               RowBox[{"Length", "[", "coeffs", "]"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ContractRatio\>\"", "\[Rule]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "/", "4"}], ")"}], "-", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 RowBox[{"Length", "[", "coeffs", "]"}]}], ")"}]}], ")"}]}]}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<ShrinkRatio\>\"", "\[Rule]", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"1", "/", 
               RowBox[{"Length", "[", "coeffs", "]"}]}], ")"}]}]}]}], "}"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"MaxIterations", "\[Rule]", 
         RowBox[{"50", " ", 
          SuperscriptBox["10", "5"]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"StepMonitor", "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"step", "++"}], ";", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{"step", ",", "500"}], "]"}], "\[Equal]", "0"}], ",", 
             RowBox[{
              RowBox[{"err", "=", 
               RowBox[{"Append", "[", 
                RowBox[{"err", ",", "scoreExpression"}], "]"}]}], ";", 
              RowBox[{"bestModel", "=", "model"}]}]}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"EvaluationMonitor", ":>", 
         RowBox[{"(", 
          RowBox[{"eval", "++"}], ")"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<steps\>\"", "\[Rule]", "step"}], ",", 
       RowBox[{"\"\<bestScore\>\"", "\[Rule]", 
        RowBox[{
        "sol", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"\"\<solution\>\"", "\[Rule]", 
        RowBox[{
        "sol", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{
        RowBox[{"\"\<model\>\"", "\[Rule]", "model"}], "/.", 
        RowBox[{
        "sol", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell["Try it with out polynomial:", "Text",
 CellChangeTimes->{{3.663924071312022*^9, 3.663924081527275*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nmSolve", "[", 
  RowBox[{"myScoreFn", ",", " ", 
   RowBox[{"ppp", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
   RowBox[{"ppp", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.663917951168041*^9, 3.663917977830982*^9}, {
   3.6639180115239534`*^9, 3.663918013428337*^9}, 3.6639180667802663`*^9, {
   3.663922957946879*^9, 3.6639229754863873`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"steps\"\>", "\[Rule]", "190"}], ",", 
   RowBox[{"\<\"bestScore\"\>", "\[Rule]", "18.391765296304538`"}], ",", 
   RowBox[{"\<\"solution\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"c1", "\[Rule]", "1.`"}], ",", 
      RowBox[{"c2", "\[Rule]", "0.0775975825226734`"}], ",", 
      RowBox[{"c3", "\[Rule]", "0.02182206237737412`"}]}], "}"}]}], ",", 
   RowBox[{"\<\"model\"\>", "\[Rule]", 
    RowBox[{
     RowBox[{"1.`", " ", "th1", " ", "th1dot", " ", "th2", " ", "th2dot"}], 
     "+", 
     RowBox[{"0.02182206237737412`", " ", "th1", " ", 
      SuperscriptBox["th1dot", "2"], " ", "th2", " ", 
      SuperscriptBox["th2dot", "2"]}], "+", 
     RowBox[{"0.0775975825226734`", " ", 
      SuperscriptBox["th1", "2"], " ", 
      SuperscriptBox["th1dot", "2"], " ", 
      SuperscriptBox["th2", "2"], " ", 
      SuperscriptBox["th2dot", "2"]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6639229764570646`*^9, 3.6639249215249014`*^9, 
  3.6639311827655687`*^9}]
}, Open  ]],

Cell["\<\
So we would send the Model back and the bestScore. Didnt Jony say that it was \
better to use NewtonMethod? We need to package all of this up. Also we dont \
want to be differentialting th1, th2 with every run of the function - or even \
calculating it each time - so maybe we should save it off with the \
experimental data and load up each time. \
\>", "Text",
 CellChangeTimes->{{3.663924115799668*^9, 3.663924199211032*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ScoreAndGetCoefficients", "[", 
   RowBox[{"polyData_", ",", " ", "expData_", ",", " ", "controlData_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "vars", ",", " ", "myPolynomial", ",", " ", "scoreFn", ",", " ", 
      "result"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vars", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"th1", ",", " ", "th2"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myPolynomial", " ", "=", " ", 
      RowBox[{"polynomialiser2", "[", 
       RowBox[{"vars", ",", " ", "polyData"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"scoreFn", " ", "=", " ", 
      RowBox[{"generateScore", "[", 
       RowBox[{"vars", ",", 
        RowBox[{"myPolynomial", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", " ", "expData", ",", " ", 
        "controlData"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", " ", "=", " ", 
      RowBox[{"nmSolve", "[", 
       RowBox[{"scoreFn", ",", " ", 
        RowBox[{"myPolynomial", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
        RowBox[{"myPolynomial", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\"\<bestScore\>\"", "/.", 
         RowBox[{"result", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"myPolynomial", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/.", "\"\<solution\>\""}], "/.", 
         RowBox[{"result", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.663924723389144*^9, 3.6639247480717163`*^9}, {
  3.663924797996235*^9, 3.6639248763667727`*^9}, {3.663929751135183*^9, 
  3.6639298978876095`*^9}, {3.663929930615878*^9, 3.66393008961902*^9}, {
  3.663931233291087*^9, 3.6639313428416276`*^9}, {3.663931427840131*^9, 
  3.663931557998316*^9}, {3.663931616129673*^9, 3.6639316828531456`*^9}, {
  3.6639317287098*^9, 3.6639317363872337`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ScoreAndGetCoefficients", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "2", ",", "1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2"}], "}"}]}], "}"}], ",", " ", 
   "myExperimentalData", ",", " ", "myControlData"}], "]"}]], "Input",
 CellChangeTimes->{{3.6639300980379934`*^9, 3.663930131986147*^9}, {
   3.6639313512616463`*^9, 3.66393135187306*^9}, 3.663931570635306*^9, {
   3.6639317077248707`*^9, 3.6639317108400574`*^9}, {3.6639317509165993`*^9, 
   3.6639317536575203`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"18.389587601152538`", ",", 
   RowBox[{"-", "0.9999999995575877`"}], ",", "0.5118793363437646`", ",", 
   RowBox[{"-", "0.045930508913528796`"}], ",", 
   RowBox[{"-", "0.6320894307484208`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6639311962351494`*^9, {3.6639312946143303`*^9, 3.663931352680643*^9}, {
   3.6639314710631475`*^9, 3.6639314925233994`*^9}, 3.6639315757289286`*^9, 
   3.66393162366003*^9, {3.663931661778167*^9, 3.6639317549584455`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PrepareData", "[", 
   RowBox[{"sz_", ",", " ", "deltat_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "experimentalData", ",", " ", "times", ",", " ", "expth1", ",", " ", 
      "expth2", ",", " ", "expw1", ",", " ", "expw2", ",", " ", "expa1", ",", 
      " ", "expa2", ",", " ", "myExperimentalData", ",", " ", 
      "myControlData"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"experimentalData", " ", "=", " ", 
      RowBox[{"Transpose", "[", " ", 
       RowBox[{"Partition", "[", " ", 
        RowBox[{
         RowBox[{"ReadList", "[", " ", 
          RowBox[{"sz", ",", " ", "Number", ",", " ", 
           RowBox[{"RecordSeparators", "\[Rule]", 
            RowBox[{"{", "\"\<,\>\"", "}"}]}]}], "]"}], ",", " ", "2"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"times", " ", "=", "  ", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"experimentalData", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}], ")"}]}], 
        "]"}], "*", "deltat"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expth1", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"times", ",", " ", 
         RowBox[{
          RowBox[{"experimentalData", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", "1*^-15"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"expth2", " ", "=", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"times", ",", " ", 
         RowBox[{
          RowBox[{"experimentalData", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "+", "1*^-15"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"expw1", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Interpolation", "[", "expth1", "]"}], ")"}], "'"}], "[", 
       "times", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expw2", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Interpolation", "[", "expth2", "]"}], ")"}], "'"}], "[", 
       "times", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expa1", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Interpolation", "[", "expth1", "]"}], ")"}], "''"}], "[", 
       "times", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expa2", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Interpolation", "[", "expth2", "]"}], ")"}], "''"}], "[", 
       "times", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expth1", " ", "=", " ", 
      RowBox[{"experimentalData", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"expth2", " ", "=", " ", 
      RowBox[{"experimentalData", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myExperimentalData", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"th1", "\[Rule]", "expth1"}], ",", " ", 
           RowBox[{
            RowBox[{"symbolAppend", "[", 
             RowBox[{"th1", ",", " ", "\"\<d\>\""}], "]"}], "\[Rule]", 
            "expw1"}], ",", " ", 
           RowBox[{
            RowBox[{"symbolAppend", "[", 
             RowBox[{"th1", ",", " ", "\"\<dd\>\""}], "]"}], "\[Rule]", 
            "expa1"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"th2", "\[Rule]", "expth2"}], ",", " ", 
           RowBox[{
            RowBox[{"symbolAppend", "[", 
             RowBox[{"th2", ",", " ", "\"\<d\>\""}], "]"}], "\[Rule]", 
            "expw2"}], ",", " ", 
           RowBox[{
            RowBox[{"symbolAppend", "[", 
             RowBox[{"th2", ",", " ", "\"\<dd\>\""}], "]"}], "\[Rule]", 
            "expa2"}]}], "}"}]}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"myControlData", " ", "=", " ", 
      RowBox[{"makeControlTrajectory", "[", 
       RowBox[{"vars", ",", " ", 
        RowBox[{"times", "[", 
         RowBox[{"[", 
          RowBox[{"Length", "[", "times", "]"}], "]"}], "]"}], ",", " ", 
        "deltat"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"myExperimentalData", ",", " ", "myControlData"}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.663935981435531*^9, 3.663936126878315*^9}, {
  3.663936160798462*^9, 3.663936242870825*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PrepareData", "[", 
  RowBox[{"\"\<c:/Users/User/Desktop/mma_double.csv\>\"", ",", " ", "0.1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6639362490133495`*^9, 3.6639362528870926`*^9}, {
  3.6639362888066616`*^9, 3.6639362932708445`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"th1", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "1.`", ",", "0.8989199993243598`", ",", "0.6012264322527066`", ",", 
        "0.20728721591523996`", ",", 
        RowBox[{"-", "0.12469131936494138`"}], ",", 
        RowBox[{"-", "0.3203010307328177`"}], ",", 
        RowBox[{"-", "0.31739157814328817`"}], ",", 
        RowBox[{"-", "0.15150573303836484`"}], ",", 
        RowBox[{"-", "0.06853590752776278`"}], ",", 
        RowBox[{"-", "0.10208675189016087`"}], ",", 
        RowBox[{"-", "0.19283938714614973`"}], ",", 
        RowBox[{"-", "0.3041667425077898`"}], ",", 
        RowBox[{"-", "0.42784503777028354`"}], ",", 
        RowBox[{"-", "0.5637214990503191`"}], ",", 
        RowBox[{"-", "0.6436598262165486`"}], ",", 
        RowBox[{"-", "0.556461294499259`"}], ",", 
        RowBox[{"-", "0.2826385812681396`"}], ",", "0.11807334789353377`", 
        ",", "0.4857189638152173`", ",", "0.6913021306892096`", ",", 
        "0.7055517780524226`", ",", "0.5722506308257261`", ",", 
        "0.4000601259592323`", ",", "0.23736876923428954`", ",", 
        "0.09480122223273243`", ",", "0.002793018560010379`", ",", 
        "0.020435421146520638`", ",", "0.18915121210814076`", ",", 
        "0.29559964634164904`", ",", "0.19155971053107798`", ",", 
        RowBox[{"-", "0.0645389453160641`"}], ",", 
        RowBox[{"-", "0.41199979729428904`"}], ",", 
        RowBox[{"-", "0.763745857310267`"}], ",", 
        RowBox[{"-", "0.9658147523027288`"}], ",", 
        RowBox[{"-", "0.9654151842309668`"}], ",", 
        RowBox[{"-", "0.7619189567478477`"}], ",", 
        RowBox[{"-", "0.3814639881360723`"}], ",", "0.019681487608635063`", 
        ",", "0.30436890958202917`", ",", "0.4084348587488139`", ",", 
        "0.3033511287685211`", ",", "0.16377080098790794`", ",", 
        "0.13211037924768504`", ",", "0.1669624228955047`", ",", 
        "0.22685663153362629`", ",", "0.29920237325085636`", ",", 
        "0.3977196592588333`", ",", "0.5249176269470148`", ",", 
        "0.5665113600861779`", ",", "0.4151813933396576`", ",", 
        "0.08338014259205495`", ",", 
        RowBox[{"-", "0.33945776612654516`"}], ",", 
        RowBox[{"-", "0.6729538983437577`"}], ",", 
        RowBox[{"-", "0.8190943458030526`"}], ",", 
        RowBox[{"-", "0.7667122609067734`"}], ",", 
        RowBox[{"-", "0.56613996650745`"}], ",", 
        RowBox[{"-", "0.3329280745275617`"}], ",", 
        RowBox[{"-", "0.12105327215003012`"}], ",", "0.04288629562864375`", 
        ",", "0.10675009790370402`", ",", 
        RowBox[{"-", "0.0012246218471329813`"}], ",", 
        RowBox[{"-", "0.19771048010865605`"}], ",", 
        RowBox[{"-", "0.20836327111761377`"}], ",", 
        RowBox[{"-", "0.0473430071408562`"}], ",", "0.21536863452407284`", 
        ",", "0.5318501320376852`", ",", "0.8203389351107336`", ",", 
        "0.945085561544485`", ",", "0.8656880388502126`", ",", 
        "0.5839868233179135`", ",", "0.15939401082395943`", ",", 
        RowBox[{"-", "0.22285894688591146`"}], ",", 
        RowBox[{"-", "0.44779233210495223`"}], ",", 
        RowBox[{"-", "0.4661579631173108`"}], ",", 
        RowBox[{"-", "0.32575683393984084`"}], ",", 
        RowBox[{"-", "0.22180368665005942`"}], ",", 
        RowBox[{"-", "0.18818819244095603`"}], ",", 
        RowBox[{"-", "0.18576678271842334`"}], ",", 
        RowBox[{"-", "0.1968715179619533`"}], ",", 
        RowBox[{"-", "0.23362802935287189`"}], ",", 
        RowBox[{"-", "0.33158415336253816`"}], ",", 
        RowBox[{"-", "0.4725833079380909`"}], ",", 
        RowBox[{"-", "0.47279998117485894`"}], ",", 
        RowBox[{"-", "0.26485131605566004`"}], ",", "0.10776493903368044`", 
        ",", "0.5367584498139469`", ",", "0.8344521790576684`", ",", 
        "0.9313115251190204`", ",", "0.8240013888669246`", ",", 
        "0.5514799939720119`", ",", "0.24539114522050504`", ",", 
        RowBox[{"-", "0.014205895564683798`"}], ",", 
        RowBox[{"-", "0.18284774301861834`"}], ",", 
        RowBox[{"-", "0.19271063152967646`"}], ",", 
        RowBox[{"-", "0.006238381238316786`"}], ",", "0.12534591122174707`", 
        ",", "0.07394787024428637`", ",", 
        RowBox[{"-", "0.09041820089881154`"}], ",", 
        RowBox[{"-", "0.31111406108502415`"}], ",", 
        RowBox[{"-", "0.5577880624881791`"}], ",", 
        RowBox[{"-", "0.7747457021632537`"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"symbolAppend", "[", 
       RowBox[{"th1", ",", "\<\"d\"\>"}], "]"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.30682754899099485`", ",", 
        RowBox[{"-", "2.161147700620134`"}], ",", 
        RowBox[{"-", "3.625443778929265`"}], ",", 
        RowBox[{"-", "3.893265975293403`"}], ",", 
        RowBox[{"-", "2.761954804665322`"}], ",", 
        RowBox[{"-", "1.0670851939669026`"}], ",", "0.9032144408756182`", ",",
         "1.654099039927152`", ",", "0.3031026562054847`", ",", 
        RowBox[{"-", "0.7203821963909505`"}], ",", 
        RowBox[{"-", "1.0714450710680437`"}], ",", 
        RowBox[{"-", "1.188734553461997`"}], ",", 
        RowBox[{"-", "1.2980284058514995`"}], ",", 
        RowBox[{"-", "1.1926344424502402`"}], ",", 
        RowBox[{"-", "0.14903018519421907`"}], ",", "1.7726273536915265`", 
        ",", "3.4722314879360865`", ",", "4.108380274034356`", ",", 
        "3.0811374736578867`", ",", "1.1479491886245037`", ",", 
        RowBox[{"-", "0.6682287075188656`"}], ",", 
        RowBox[{"-", "1.7085606553828043`"}], ",", 
        RowBox[{"-", "1.755056817592762`"}], ",", 
        RowBox[{"-", "1.5440022879355557`"}], ",", 
        RowBox[{"-", "1.2236046427138112`"}], ",", 
        RowBox[{"-", "0.4703144436483918`"}], ",", "0.8627529975475229`", ",",
         "1.73138903448101`", ",", "0.2590775143079651`", ",", 
        RowBox[{"-", "1.8980757083010822`"}], ",", 
        RowBox[{"-", "3.1189584123026544`"}], ",", 
        RowBox[{"-", "3.6411628734598933`"}], ",", 
        RowBox[{"-", "3.0256787301443113`"}], ",", 
        RowBox[{"-", "1.096332131338011`"}], ",", "1.0184319838625207`", ",", 
        "2.9633191776123105`", ",", "4.16844927844195`", ",", 
        "3.657745423430913`", ",", "2.0507058874263855`", ",", 
        "0.042458106499903336`", ",", 
        RowBox[{"-", "1.5144087577157923`"}], ",", 
        RowBox[{"-", "1.0935645873386894`"}], ",", "0.08497051062522709`", 
        ",", "0.5428484287592741`", ",", "0.6821841382954124`", ",", 
        "0.8314484532733047`", ",", "1.1243943728316936`", ",", 
        "1.0344333645187669`", ",", 
        RowBox[{"-", "0.3698153924756866`"}], ",", 
        RowBox[{"-", "2.4364101139449557`"}], ",", 
        RowBox[{"-", "3.922253507381156`"}], ",", 
        RowBox[{"-", "4.082300928799687`"}], ",", 
        RowBox[{"-", "2.561539412143436`"}], ",", 
        RowBox[{"-", "0.48740322547782555`"}], ",", "1.3486591012322307`", 
        ",", "2.361505285100192`", ",", "2.31539461709196`", ",", 
        "1.9234020924418684`", ",", "1.2259177351099204`", ",", 
        RowBox[{"-", "0.10094999317507514`"}], ",", 
        RowBox[{"-", "1.6611818625871515`"}], ",", 
        RowBox[{"-", "1.4929335892911435`"}], ",", "0.7754373852837406`", ",",
         "2.235295657037671`", ",", "2.975834898958532`", ",", 
        "3.161122420082053`", ",", "2.2924262845318717`", ",", 
        "0.2940821395119513`", ",", 
        RowBox[{"-", "1.8085611182828574`"}], ",", 
        RowBox[{"-", "3.6304902999252313`"}], ",", 
        RowBox[{"-", "4.3429479372620285`"}], ",", 
        RowBox[{"-", "3.2275645774891166`"}], ",", 
        RowBox[{"-", "1.2985753840167642`"}], ",", "0.6898458141869873`", ",",
         "1.547129285798788`", ",", "0.7443259928160761`", ",", 
        "0.11494523866799872`", ",", 
        RowBox[{"-", "0.07286319347249887`"}], ",", 
        RowBox[{"-", "0.2190968478700332`"}], ",", 
        RowBox[{"-", "0.614316782883995`"}], ",", 
        RowBox[{"-", "1.2250373630142013`"}], ",", 
        RowBox[{"-", "1.012454992236067`"}], ",", "0.9263551977168627`", ",", 
        "2.9753208483524127`", ",", "4.188532719813409`", ",", 
        "3.946231262165739`", ",", "2.0886563792684174`", ",", 
        RowBox[{"-", "0.046695452401945836`"}], ",", 
        RowBox[{"-", "1.9640880285194275`"}], ",", 
        RowBox[{"-", "3.112457559542481`"}], ",", 
        RowBox[{"-", "2.9618615507216757`"}], ",", 
        RowBox[{"-", "2.2153000834705123`"}], ",", 
        RowBox[{"-", "1.0055632891776387`"}], ",", "0.8204531758022681`", ",",
         "2.008987874813314`", ",", "0.6144218834234102`", ",", 
        RowBox[{"-", "1.1955110660559407`"}], ",", 
        RowBox[{"-", "2.019706725184097`"}], ",", 
        RowBox[{"-", "2.3874353876571335`"}], ",", 
        RowBox[{"-", "2.4109823769661944`"}], ",", 
        RowBox[{"-", "1.835346244960273`"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"symbolAppend", "[", 
       RowBox[{"th1", ",", "\<\"dd\"\>"}], "]"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "29.698148352621274`"}], ",", 
        RowBox[{"-", "19.661356639601298`"}], ",", 
        RowBox[{"-", "9.624564926581314`"}], ",", "6.196068105728512`", ",", 
        "13.636882391230504`", ",", "19.851916395740574`", ",", 
        "16.29763925153938`", ",", 
        RowBox[{"-", "8.291601959432134`"}], ",", 
        RowBox[{"-", "11.65206698730002`"}], ",", 
        RowBox[{"-", "5.720179089359081`"}], ",", 
        RowBox[{"-", "2.0574720105651063`"}], ",", 
        RowBox[{"-", "1.235093990085362`"}], ",", 
        RowBox[{"-", "1.2198166017542105`"}], ",", "5.593813411380626`", ",", 
        "16.713685888351932`", ",", "18.66241815138294`", ",", 
        "12.688921593055376`", ",", 
        RowBox[{"-", "3.306631323998922`"}], ",", 
        RowBox[{"-", "16.206244904769182`"}], ",", 
        RowBox[{"-", "19.13335195107792`"}], ",", 
        RowBox[{"-", "14.755079458990947`"}], ",", 
        RowBox[{"-", "3.888935763979725`"}], ",", "0.9499148141551075`", ",", 
        "2.0123809723385593`", ",", "5.055934332883472`", ",", 
        "10.965060625923268`", ",", "15.107338837510959`", ",", 
        RowBox[{"-", "6.226735672811174`"}], ",", 
        RowBox[{"-", "21.048837004407897`"}], ",", 
        RowBox[{"-", "15.205872003657213`"}], ",", 
        RowBox[{"-", "9.136219613108194`"}], ",", 
        RowBox[{"-", "0.4285208037753026`"}], ",", "14.967716502351585`", ",",
         "20.24684630642235`", ",", "20.309665941135815`", ",", 
        "17.695874112865553`", ",", "2.0690507132931906`", ",", 
        RowBox[{"-", "11.645805377131307`"}], ",", 
        RowBox[{"-", "18.0621472806609`"}], ",", 
        RowBox[{"-", "20.914967914707812`"}], ",", 
        RowBox[{"-", "3.4496597800319706`"}], ",", "10.791990604038974`", ",",
         "6.651246538804303`", ",", "2.5042164990301585`", ",", 
        "1.2451533079109007`", ",", "2.617154429074602`", ",", 
        "2.8680681680205566`", ",", 
        RowBox[{"-", "8.560423454901876`"}], ",", 
        RowBox[{"-", "19.292369988568378`"}], ",", 
        RowBox[{"-", "18.04712840010836`"}], ",", 
        RowBox[{"-", "9.103665797099426`"}], ",", "8.93417765013846`", ",", 
        "18.73556847579192`", ",", "19.852253235557342`", ",", 
        "14.81902095030451`", ",", "3.263959758056333`", ",", 
        RowBox[{"-", "2.1337089602354955`"}], ",", 
        RowBox[{"-", "4.793523459885917`"}], ",", 
        RowBox[{"-", "10.007576550361254`"}], ",", 
        RowBox[{"-", "17.183852202589847`"}], ",", 
        RowBox[{"-", "8.851113851068474`"}], ",", "18.583306725256495`", ",", 
        "17.167305498571434`", ",", "10.169137768817299`", ",", 
        "5.376985584868354`", ",", 
        RowBox[{"-", "2.799269444056623`"}], ",", 
        RowBox[{"-", "16.374217663929542`"}], ",", 
        RowBox[{"-", "20.414414912802343`"}], ",", 
        RowBox[{"-", "20.230369283802798`"}], ",", 
        RowBox[{"-", "14.289159696165601`"}], ",", "4.233985478408607`", ",", 
        "15.731957249082749`", ",", "20.65677542066828`", ",", 
        "15.876676018982861`", ",", 
        RowBox[{"-", "3.644798188768878`"}], ",", 
        RowBox[{"-", "7.03376530806784`"}], ",", 
        RowBox[{"-", "3.1194084486570386`"}], ",", 
        RowBox[{"-", "1.3526144966062625`"}], ",", 
        RowBox[{"-", "2.5651776147388845`"}], ",", 
        RowBox[{"-", "6.119961261874812`"}], ",", 
        RowBox[{"-", "4.304303056588676`"}], ",", "14.078248133878335`", ",", 
        "20.816533835596697`", ",", "16.466758997014267`", ",", 
        "5.637725569092649`", ",", 
        RowBox[{"-", "13.1299781536546`"}], ",", 
        RowBox[{"-", "20.083438318237047`"}], ",", 
        RowBox[{"-", "20.416948231344563`"}], ",", 
        RowBox[{"-", "16.521125864281824`"}], ",", 
        RowBox[{"-", "3.356745385659424`"}], ",", "4.649180796631835`", ",", 
        "9.095519333125694`", ",", "15.877895894287352`", ",", 
        "19.63351388024192`", ",", 
        RowBox[{"-", "5.488795783129616`"}], ",", 
        RowBox[{"-", "18.29823334375226`"}], ",", 
        RowBox[{"-", "11.296803016563754`"}], ",", 
        RowBox[{"-", "5.632978904311508`"}], ",", 
        RowBox[{"-", "2.597814121694251`"}], ",", "2.971636172808065`", ",", 
        "8.541086467310393`"}], "}"}]}], ",", 
     RowBox[{"th2", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "0.5`", ",", "0.5273773323698951`", ",", "0.6150146061532324`", ",", 
        "0.6867637450857415`", ",", "0.6128755226651414`", ",", 
        "0.3759753033776718`", ",", 
        RowBox[{"-", "0.00891222272756455`"}], ",", 
        RowBox[{"-", "0.4859843812105411`"}], ",", 
        RowBox[{"-", "0.8596378945099428`"}], ",", 
        RowBox[{"-", "1.0880175001724761`"}], ",", 
        RowBox[{"-", "1.1855488923462065`"}], ",", 
        RowBox[{"-", "1.1575073908741338`"}], ",", 
        RowBox[{"-", "1.0063385347323577`"}], ",", 
        RowBox[{"-", "0.7409760400090484`"}], ",", 
        RowBox[{"-", "0.42663491254056624`"}], ",", 
        RowBox[{"-", "0.16332995583459806`"}], ",", "0.00313006770448885`", 
        ",", "0.07657583412271292`", ",", "0.1636055429524412`", ",", 
        "0.3409737545282742`", ",", "0.5938523347108549`", ",", 
        "0.8689500002921885`", ",", "1.0703696819982962`", ",", 
        "1.1499902909294584`", ",", "1.09921817125142`", ",", 
        "0.9148241706177372`", ",", "0.5887099607550005`", ",", 
        "0.11546087486737448`", ",", 
        RowBox[{"-", "0.3352012939175865`"}], ",", 
        RowBox[{"-", "0.6374287103167247`"}], ",", 
        RowBox[{"-", "0.7847775717140719`"}], ",", 
        RowBox[{"-", "0.7671413329890023`"}], ",", 
        RowBox[{"-", "0.637892645069462`"}], ",", 
        RowBox[{"-", "0.5291651228069204`"}], ",", 
        RowBox[{"-", "0.4769995584447674`"}], ",", 
        RowBox[{"-", "0.48575035287369117`"}], ",", 
        RowBox[{"-", "0.5532310885650046`"}], ",", 
        RowBox[{"-", "0.5531692758934087`"}], ",", 
        RowBox[{"-", "0.3912589310921021`"}], ",", 
        RowBox[{"-", "0.0779292378679363`"}], ",", "0.3606477936759421`", ",",
         "0.7774445959489588`", ",", "1.052618500116024`", ",", 
        "1.1955554771672163`", ",", "1.2153438737438662`", ",", 
        "1.1141115554095216`", ",", "0.8889440285610497`", ",", 
        "0.5513810440539018`", ",", "0.20244026369872878`", ",", 
        RowBox[{"-", "0.05681057672314274`"}], ",", 
        RowBox[{"-", "0.19160561660471556`"}], ",", 
        RowBox[{"-", "0.2285229711276155`"}], ",", 
        RowBox[{"-", "0.2989790415121534`"}], ",", 
        RowBox[{"-", "0.45480098142639636`"}], ",", 
        RowBox[{"-", "0.6749425063827657`"}], ",", 
        RowBox[{"-", "0.9094739078608727`"}], ",", 
        RowBox[{"-", "1.0575241567889448`"}], ",", 
        RowBox[{"-", "1.0698642995934966`"}], ",", 
        RowBox[{"-", "0.9397360032321105`"}], ",", 
        RowBox[{"-", "0.6674124464434056`"}], ",", 
        RowBox[{"-", "0.2399759747967363`"}], ",", "0.2667689694170905`", ",",
         "0.6400580579094078`", ",", "0.8623641661791187`", ",", 
        "0.9296901822527296`", ",", "0.8414607796897818`", ",", 
        "0.6619901861846117`", ",", "0.5084990646688763`", ",", 
        "0.4130530475111119`", ",", "0.3918159994019021`", ",", 
        "0.4201765296637072`", ",", "0.3507218638943464`", ",", 
        "0.12668887943057722`", ",", 
        RowBox[{"-", "0.2295676834221329`"}], ",", 
        RowBox[{"-", "0.65183281816219`"}], ",", 
        RowBox[{"-", "0.9792526718782775`"}], ",", 
        RowBox[{"-", "1.1714530923300341`"}], ",", 
        RowBox[{"-", "1.2398543020068622`"}], ",", 
        RowBox[{"-", "1.188508569195829`"}], ",", 
        RowBox[{"-", "1.0145663696594325`"}], ",", 
        RowBox[{"-", "0.7077893015816162`"}], ",", 
        RowBox[{"-", "0.29694687500599043`"}], ",", "0.06550229656748253`", 
        ",", "0.301772028672801`", ",", "0.3872985570654786`", ",", 
        "0.36943128095627253`", ",", "0.39598336347445034`", ",", 
        "0.49961026012135046`", ",", "0.6624847467718888`", ",", 
        "0.8519426659243755`", ",", "0.9543707079885553`", ",", 
        "0.9045250714705957`", ",", "0.7006813353503054`", ",", 
        "0.34712433586419034`", ",", 
        RowBox[{"-", "0.1521973416376246`"}], ",", 
        RowBox[{"-", "0.6015989351938787`"}], ",", 
        RowBox[{"-", "0.8940901509067573`"}], ",", 
        RowBox[{"-", "1.0427348850024962`"}], ",", 
        RowBox[{"-", "1.0464947142202496`"}], ",", 
        RowBox[{"-", "0.9108663835615147`"}], ",", 
        RowBox[{"-", "0.6852351460783989`"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"symbolAppend", "[", 
       RowBox[{"th2", ",", "\<\"d\"\>"}], "]"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.28135330424916094`"}], ",", "0.701986491206613`", ",",
         "0.9238455240196822`", ",", "0.20555329339667916`", ",", 
        RowBox[{"-", "1.5249844826840806`"}], ",", 
        RowBox[{"-", "3.133979877045367`"}], ",", 
        RowBox[{"-", "4.402802880341107`"}], ",", 
        RowBox[{"-", "4.579633821514085`"}], ",", 
        RowBox[{"-", "3.079924365565164`"}], ",", 
        RowBox[{"-", "1.6055121656012092`"}], ",", 
        RowBox[{"-", "0.3386572537699559`"}], ",", "0.9001276863627434`", ",",
         "2.097546281139044`", ",", "3.007209787352892`", ",", 
        "3.054921760051728`", ",", "2.225172838565891`", ",", 
        "1.193144489709855`", ",", "0.6247137103524838`", ",", 
        "1.1940653348034724`", ",", "2.175947515690997`", ",", 
        "2.7287000341662315`", ",", "2.5424151852271684`", ",", 
        "1.4854032680192149`", ",", "0.15856520598937707`", ",", 
        RowBox[{"-", "1.1704486809812025`"}], ",", 
        RowBox[{"-", "2.539043838693085`"}], ",", 
        RowBox[{"-", "3.987792034092084`"}], ",", 
        RowBox[{"-", "4.902425928575521`"}], ",", 
        RowBox[{"-", "3.974194318059088`"}], ",", 
        RowBox[{"-", "2.2586210600090393`"}], ",", 
        RowBox[{"-", "0.6654073552291051`"}], ",", "0.8233790514362944`", ",",
         "1.4101037423295244`", ",", "0.8645334201957885`", ",", 
        "0.22433118448395917`", ",", 
        RowBox[{"-", "0.38480167981566404`"}], ",", 
        RowBox[{"-", "0.5475487644740858`"}], ",", "0.6526841477531762`", ",",
         "2.3935821629721126`", ",", "3.803153640678802`", ",", 
        "4.521915115068772`", ",", "3.6595913135922054`", ",", 
        "2.074911121107839`", ",", "0.7984796237369975`", ",", 
        RowBox[{"-", "0.41076605139439265`"}], ",", 
        RowBox[{"-", "1.6271417365755245`"}], ",", 
        RowBox[{"-", "2.8328854748705146`"}], ",", 
        RowBox[{"-", "3.600881593996028`"}], ",", 
        RowBox[{"-", "3.209404330187417`"}], ",", 
        RowBox[{"-", "2.028172502528897`"}], ",", 
        RowBox[{"-", "0.8142651133863238`"}], ",", 
        RowBox[{"-", "0.3178397891700031`"}], ",", 
        RowBox[{"-", "1.0450114620471236`"}], ",", 
        RowBox[{"-", "1.9148944651656894`"}], ",", 
        RowBox[{"-", "2.3565808130397055`"}], ",", 
        RowBox[{"-", "2.0810266338171886`"}], ",", 
        RowBox[{"-", "0.8840002146189172`"}], ",", "0.577676879380135`", ",", 
        "2.012714563648153`", ",", "3.477270718125808`", ",", 
        "4.797247816453827`", ",", "4.754777377345142`", ",", 
        "3.007187857978651`", ",", "1.4548224750057497`", ",", 
        RowBox[{"-", "0.10355805504591586`"}], ",", 
        RowBox[{"-", "1.4456903598311492`"}], ",", 
        RowBox[{"-", "1.8601763466572827`"}], ",", 
        RowBox[{"-", "1.298128413981732`"}], ",", 
        RowBox[{"-", "0.6103551008191705`"}], ",", "0.07663639522554108`", 
        ",", "0.04021727979919476`", ",", 
        RowBox[{"-", "1.3728330467269156`"}], ",", 
        RowBox[{"-", "2.938705637091507`"}], ",", 
        RowBox[{"-", "4.002966832133149`"}], ",", 
        RowBox[{"-", "4.016514697132934`"}], ",", 
        RowBox[{"-", "2.665391624573162`"}], ",", 
        RowBox[{"-", "1.2839744464939065`"}], ",", 
        RowBox[{"-", "0.07852360385053625`"}], ",", "1.1216904546746478`", 
        ",", "2.3865323350443113`", ",", "3.6360466566732392`", ",", 
        "4.120555679912096`", ",", "3.1232381591705787`", ",", 
        "1.6499209095641425`", ",", "0.25938059606609654`", ",", 
        RowBox[{"-", "0.2029312398372547`"}], ",", "0.5964691366564854`", ",",
         "1.3622189566956582`", ",", "1.81610229151795`", ",", 
        "1.6487853220670965`", ",", "0.37165169688748967`", ",", 
        RowBox[{"-", "1.2655728281575849`"}], ",", 
        RowBox[{"-", "2.794145071759523`"}], ",", 
        RowBox[{"-", "4.27097436052321`"}], ",", 
        RowBox[{"-", "5.069757625225797`"}], ",", 
        RowBox[{"-", "3.8877812028420244`"}], ",", 
        RowBox[{"-", "2.1839065886659847`"}], ",", 
        RowBox[{"-", "0.7637535220022179`"}], ",", "0.6685037488740713`", ",",
         "1.8886065957961056`", ",", "2.541709398779383`"}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"symbolAppend", "[", 
       RowBox[{"th2", ",", "\<\"dd\"\>"}], "]"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"13.640801767771263`", ",", "6.025994141344215`", ",", 
        RowBox[{"-", "1.5888134850828306`"}], ",", 
        RowBox[{"-", "14.5637361353109`"}], ",", 
        RowBox[{"-", "16.30119968668697`"}], ",", 
        RowBox[{"-", "14.798730681776627`"}], ",", 
        RowBox[{"-", "9.218463237774062`"}], ",", "10.341864518357495`", ",", 
        "14.527390763686853`", ",", "13.084821348880292`", ",", 
        "12.55728936458031`", ",", "12.312735466970315`", ",", 
        "11.419363858153362`", ",", "4.897863274517231`", ",", 
        RowBox[{"-", "5.1036170762513375`"}], ",", 
        RowBox[{"-", "9.68449331668818`"}], ",", 
        RowBox[{"-", "9.301425712086267`"}], ",", "1.35839424115045`", ",", 
        "9.033850274610442`", ",", "7.551036860674811`", ",", 
        "2.221908539875248`", ",", 
        RowBox[{"-", "7.367798387522575`"}], ",", 
        RowBox[{"-", "12.179907277494541`"}], ",", 
        RowBox[{"-", "13.039272860920036`"}], ",", 
        RowBox[{"-", "13.36218809556453`"}], ",", 
        RowBox[{"-", "14.172020922905316`"}], ",", 
        RowBox[{"-", "14.71348760248891`"}], ",", "2.2586917102664983`", ",", 
        "14.843475238582263`", ",", "15.487855500179032`", ",", 
        "16.49851001224176`", ",", "11.161244919447059`", ",", 
        RowBox[{"-", "2.052116565699878`"}], ",", 
        RowBox[{"-", "5.656195790038844`"}], ",", 
        RowBox[{"-", "6.09163587910769`"}], ",", 
        RowBox[{"-", "5.872994126238961`"}], ",", "6.754254836290918`", ",", 
        "16.184853212971046`", ",", "15.141934842285888`", ",", 
        "12.524733831971467`", ",", 
        RowBox[{"-", "2.1780229270865075`"}], ",", 
        RowBox[{"-", "14.162289810594851`"}], ",", 
        RowBox[{"-", "13.223692711587393`"}], ",", 
        RowBox[{"-", "12.314858047454303`"}], ",", 
        RowBox[{"-", "12.102071491099467`"}], ",", 
        RowBox[{"-", "12.393520851412566`"}], ",", 
        RowBox[{"-", "11.239545765867831`"}], ",", 
        RowBox[{"-", "1.1377795848022272`"}], ",", "8.968993993329883`", ",", 
        "12.445580054029953`", ",", "9.787768535867357`", ",", 
        RowBox[{"-", "3.3538715861638746`"}], ",", 
        RowBox[{"-", "8.536586952970376`"}], ",", 
        RowBox[{"-", "6.431958504212777`"}], ",", 
        RowBox[{"-", "1.4389876521737806`"}], ",", "8.648115255003622`", ",", 
        "13.571010612351946`", ",", "14.246843916593697`", ",", 
        "14.219526042732037`", ",", "15.51129148579655`", ",", 
        "7.930847256715336`", ",", 
        RowBox[{"-", "13.345585572150597`"}], ",", 
        RowBox[{"-", "15.098298022260876`"}], ",", 
        RowBox[{"-", "15.498009219609841`"}], ",", 
        RowBox[{"-", "15.555541863655975`"}], ",", 
        RowBox[{"-", "9.124119094222126`"}], ",", "2.597947198943355`", ",", 
        "5.8045104357971935`", ",", "7.4208969048554`", ",", 
        "4.959757837101527`", ",", 
        RowBox[{"-", "9.781519603116514`"}], ",", 
        RowBox[{"-", "15.457831869440954`"}], ",", 
        RowBox[{"-", "13.222357838893817`"}], ",", 
        RowBox[{"-", "6.600857188735002`"}], ",", "9.484528102397032`", ",", 
        "13.521943326433282`", ",", "12.37992107749271`", ",", 
        "11.974694248786111`", ",", "12.259646672536416`", ",", 
        "13.28348685414205`", ",", "10.406535849781042`", ",", 
        RowBox[{"-", "4.839325500215824`"}], ",", 
        RowBox[{"-", "12.617943946814824`"}], ",", 
        RowBox[{"-", "15.074320371264195`"}], ",", 
        RowBox[{"-", "10.33938045018844`"}], ",", "4.44193586273842`", ",", 
        "7.7074814128720135`", ",", "5.924759000363992`", ",", 
        "2.658343250194846`", ",", 
        RowBox[{"-", "8.70298770883075`"}], ",", 
        RowBox[{"-", "15.227367858214041`"}], ",", 
        RowBox[{"-", "15.399809960232679`"}], ",", 
        RowBox[{"-", "14.971326336582809`"}], ",", 
        RowBox[{"-", "14.576467801570086`"}], ",", "4.992008394556127`", ",", 
        "15.691037784337984`", ",", "14.38464816171341`", ",", 
        "14.488490487798648`", ",", "13.93881598764892`", ",", 
        "9.00029068243817`", ",", "4.061765377227421`"}], "}"}]}]}], "}"}], 
   ",", 
   RowBox[{"makeControlTrajectory", "[", 
    RowBox[{"vars", ",", "10.`", ",", "0.1`"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.663936293741169*^9}]
}, Open  ]]
}, Open  ]]
},
WindowToolbars->{"RulerBar", "EditBar"},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (December 4, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 192, 4, 101, "Title"],
Cell[775, 28, 129, 1, 30, "Text"],
Cell[907, 31, 481, 12, 31, "Input"],
Cell[1391, 45, 299, 7, 31, "Input"],
Cell[1693, 54, 145, 3, 31, "Input"],
Cell[1841, 59, 422, 12, 31, "Input"],
Cell[2266, 73, 221, 4, 30, "Text"],
Cell[2490, 79, 2024, 58, 172, "Input"],
Cell[4517, 139, 218, 4, 30, "Text"],
Cell[4738, 145, 1279, 31, 52, "Input"],
Cell[6020, 178, 509, 14, 52, "Input"],
Cell[6532, 194, 83, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[6640, 199, 1277, 34, 152, "Input"],
Cell[7920, 235, 1025, 29, 31, "Output"]
}, Open  ]],
Cell[8960, 267, 16, 0, 30, "Text"],
Cell[8979, 269, 130, 1, 30, "Text"],
Cell[9112, 272, 1734, 46, 159, "Input"],
Cell[10849, 320, 326, 11, 31, "Input"],
Cell[11178, 333, 198, 5, 31, "Input"],
Cell[11379, 340, 110, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[11514, 345, 738, 16, 52, "Input"],
Cell[12255, 363, 507, 12, 31, "Output"]
}, Open  ]],
Cell[12777, 378, 231, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[13033, 386, 350, 6, 31, "Input"],
Cell[13386, 394, 659, 16, 33, "Output"]
}, Open  ]],
Cell[14060, 413, 275, 5, 30, "Text"],
Cell[14338, 420, 1441, 38, 120, "Input"],
Cell[15782, 460, 1515, 41, 120, "Input"],
Cell[17300, 503, 248, 8, 35, "Input"],
Cell[17551, 513, 181, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[17757, 521, 381, 9, 31, "Input"],
Cell[18141, 532, 10999, 299, 190, "Output"]
}, Open  ]],
Cell[29155, 834, 1180, 31, 92, "Input"],
Cell[30338, 867, 383, 8, 49, "Text"],
Cell[30724, 877, 599, 13, 31, "Input"],
Cell[31326, 892, 276, 5, 30, "Text"],
Cell[31605, 899, 1143, 32, 92, "Input"],
Cell[32751, 933, 1483, 42, 76, "Input"],
Cell[34237, 977, 169, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[34431, 984, 937, 19, 31, "Input"],
Cell[35371, 1005, 743, 15, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36151, 1025, 531, 14, 31, "Input"],
Cell[36685, 1041, 620, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37342, 1058, 530, 14, 31, "Input"],
Cell[37875, 1074, 732, 15, 35, "Output"]
}, Open  ]],
Cell[38622, 1092, 109, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[38756, 1097, 575, 12, 31, "Input"],
Cell[39334, 1111, 2705, 58, 135, "Output"]
}, Open  ]],
Cell[42054, 1172, 103, 1, 30, "Text"],
Cell[42160, 1175, 3848, 93, 362, "Input"],
Cell[46011, 1270, 109, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[46145, 1275, 417, 9, 31, "Input"],
Cell[46565, 1286, 1043, 24, 55, "Output"]
}, Open  ]],
Cell[47623, 1313, 438, 7, 49, "Text"],
Cell[48064, 1322, 2185, 51, 152, "Input"],
Cell[CellGroupData[{
Cell[50274, 1377, 767, 17, 31, "Input"],
Cell[51044, 1396, 498, 9, 31, "Output"]
}, Open  ]],
Cell[51557, 1408, 4776, 117, 392, "Input"],
Cell[CellGroupData[{
Cell[56358, 1529, 263, 5, 31, "Input"],
Cell[56624, 1536, 26482, 477, 852, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
